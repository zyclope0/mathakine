{% extends "base.html" %}

{% block title %}Accueil - Mathakine{% endblock %}

{% block head %}
<!-- Déjà chargé conditionnellement dans le template base.html -->
{% endblock %}

{% block content %}
<div class="hero-section">
    <div class="stars-container">
        <!-- Les étoiles et planètes seront ajoutées ici par JavaScript -->
    </div>
    
    <div class="card hero-card">
        <h2>Bienvenue dans l'univers de Mathakine</h2>
        <p class="hero-subtitle">Embarquez pour un voyage intergalactique où les mathématiques deviennent une aventure cosmique !</p>
        
        <div class="action-buttons">
            <a href="/exercises" class="btn big-btn"><i class="fas fa-rocket"></i> Explorer les exercices</a>
            <a href="/api/exercises/generate" class="btn big-btn primary-btn"><i class="fas fa-meteor"></i> Générer un exercice</a>
        </div>
    </div>
</div>

<div class="features-section">
    <div class="card feature-card">
        <div class="feature-icon"><i class="fas fa-calculator"></i></div>
        <h3>Opérations Stellaires</h3>
        <p>Maîtrisez les additions, soustractions, multiplications et divisions comme un véritable navigateur spatial</p>
    </div>
    
    <div class="card feature-card">
        <div class="feature-icon"><i class="fas fa-chart-line"></i></div>
        <h3>Progression Cosmique</h3>
        <p>Suivez vos résultats et observez votre progression à travers le tableau de bord galactique</p>
    </div>
    
    <div class="card feature-card">
        <div class="feature-icon"><i class="fas fa-robot"></i></div>
        <h3>L'API Rebelle</h3>
        <p>Explorez notre nouvelle API qui permet de générer des exercices personnalisés adaptés à votre niveau</p>
    </div>
</div>

<div class="card about-card">
    <h3>À propos de "L'API Rebelle"</h3>
    <p>La nouvelle version 3.0 de Mathakine - "L'API Rebelle" - offre une expérience entièrement repensée avec :</p>
    <ul>
        <li>Une interface utilisateur inspirée de l'espace et des thèmes cosmiques</li>
        <li>Une API puissante pour la génération d'exercices personnalisés</li>
        <li>Des modèles de données validés et sécurisés</li>
        <li>Un système plus robuste et extensible</li>
    </ul>
    <p class="version-note">Rejoignez la rébellion mathématique et développez vos compétences à travers la galaxie !</p>
</div>
{% endblock %}

{% block scripts %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Créer les éléments spatiaux avec une approche plus performante
        createSpaceElements();
        
        // Ajouter des transitions fluides entre les sections
        addScrollAnimations();
    });
    
    // Version optimisée de la création des éléments spatiaux
    function createSpaceElements() {
        const container = document.querySelector('.stars-container');
        if (!container) return;
        
        // Utiliser DocumentFragment pour minimiser les reflows
        const fragment = document.createDocumentFragment();
        
        // Créer les étoiles
        const starCount = Math.min(15, Math.floor(window.innerWidth / 80)); // Adapter le nombre au viewport
        for (let i = 0; i < starCount; i++) {
            const star = document.createElement('div');
            star.classList.add('star');
            
            // Position aléatoire mais contrôlée
            const top = 10 + Math.random() * 80;
            const left = 10 + Math.random() * 80;
            
            // Taille aléatoire contrôlée
            const size = 1 + Math.random() * 1.5;
            
            Object.assign(star.style, {
                position: 'absolute',
                top: `${top}%`,
                left: `${left}%`,
                width: `${size}px`,
                height: `${size}px`,
                zIndex: '0'
            });
            
            // Animation via la classe plutôt que style inline pour de meilleures performances
            star.dataset.delay = Math.random() * 5;
            star.dataset.duration = 1 + Math.random() * 2;
            
            fragment.appendChild(star);
        }
        
        // Ajouter quelques planètes, à des positions spécifiques
        const planets = [
            { color: 'planet-blue', size: 10, top: 25, left: 85 },
            { color: 'planet-red', size: 12, top: 75, left: 15 },
            { color: 'planet-green', size: 8, top: 45, left: 75 }
        ];
        
        planets.forEach(planetData => {
            const planet = document.createElement('div');
            planet.classList.add('floating-planet', planetData.color);
            
            Object.assign(planet.style, {
                position: 'absolute',
                top: `${planetData.top}%`,
                left: `${planetData.left}%`,
                width: `${planetData.size}px`,
                height: `${planetData.size}px`,
                zIndex: '0'
            });
            
            fragment.appendChild(planet);
        });
        
        // Ajouter tous les éléments d'un coup pour minimiser les reflows
        container.appendChild(fragment);
        
        // Appliquer les animations après le rendu pour de meilleures performances
        requestAnimationFrame(() => {
            document.querySelectorAll('.star').forEach(star => {
                const delay = star.dataset.delay;
                const duration = star.dataset.duration;
                star.style.animation = `optimizedTwinkle ${duration}s infinite ${delay}s`;
            });
        });
    }
    
    // Ajouter des animations au scroll
    function addScrollAnimations() {
        const cards = document.querySelectorAll('.card:not(.hero-card)');
        
        // Si IntersectionObserver est supporté
        if ('IntersectionObserver' in window) {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('fade-in-up');
                        observer.unobserve(entry.target); // Une fois animé, on arrête d'observer
                    }
                });
            }, {
                threshold: 0.1
            });
            
            cards.forEach(card => {
                card.style.opacity = '0';
                card.style.transform = 'translateY(20px)';
                card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
                observer.observe(card);
            });
        } else {
            // Fallback pour les navigateurs qui ne supportent pas IntersectionObserver
            cards.forEach(card => card.classList.add('fade-in-up'));
        }
    }
</script>

<style>
    /* Styles pour les animations de scroll */
    .fade-in-up {
        animation: fadeInUp 0.5s ease forwards;
    }
    
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    /* Optimisation pour préférence de mouvement réduit */
    @media (prefers-reduced-motion: reduce) {
        .fade-in-up {
            animation: none;
            opacity: 1;
            transform: translateY(0);
        }
    }
</style>
{% endblock %} 